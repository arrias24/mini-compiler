#include <iostream>
#include <fstream>
#include <string>
#include "operations_analyzer/operations_analyzer.h"


int main() {
    std::ifstream configFile("../config/lexical_config.csv");
    std::ifstream codeFile("../src/test/operations_analyzer.txt");
    if (!configFile.is_open() || !codeFile.is_open()) {
        std::cerr << "Error al abrir los archivos de prueba." << std::endl;
        return 1;
    }
    try {
        std::cout << std::endl;
        std::cout << "--- Iniciando Analisis Lexico ---" << std::endl;
        LexicalAnalyzer lexer(configFile);
        ArrayList<NodeStruct> tokens = lexer.tokenize(codeFile);

        std::cout << "Tokens generados: ";
        do {
            std::cout<< " " << tokens.get()->getData().name << " ";
        } while (tokens.currentNext());
        std::cout << std::endl;
        std::cout << std::endl;

        std::cout << "--- Evaluando con OperationsAnalyzer ---" << std::endl;

        tokens.currentReset();

        OperationsAnalyzer analyzer(tokens);

        analyzer.resolve();
    } catch (const std::exception& e) {
        std::cerr << "Error durante la ejecucion: " << e.what() << std::endl;
    }

    remove("config.csv");
    remove("code.txt");

    return 0;
}